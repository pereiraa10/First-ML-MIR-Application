# First-ML-MIR-Application
Python scripts I wrote to test out Music Information Retrieval functions within the context of Machine Learning

This repository contains the written documentation of my journey to producing my first research paper on music information retrieval using machine learning techniques. Please note, the songs referenced in this project are original compositions and cannot be reproduced without the express written consent of the original composer.

# A Journey through Suno 

## Objective: 

Explore features of suno music.AI platform with the objective of creating musical accompaniment for an original song. 

## Intro / Backstory:

I had been tasked with composing a piano arrangement for an original song. I was provided a recording of voice accompanied by simple triads played on a piano, and a chart with the lyrics and chords. 

I spent some time playing through ideas on the piano and recording them, but never created a flawless product that was usable for a demo or recording purposes. Being familiar with digital audio workspaces like garage band, I decided to invest in a MIDI controllers to play and capture my ideas, but also be able to edit and reshuffle portions in order to create a more refined output. Battling an overwhelming amount of buttons and a sense of perfectionism, I struggled to efficiently piece together a usable recording of the accompaniment I could dream of. 

I am aware there are new generative music tools being published to the public and wanted to test out if these tools could help me in my quest to quickly produce the desired output, which is a simple yet mastery level accompaniment track. I downloaded the Suno and started to feed it 60 second audio samples from the original recording of the song that I received from the artist. As part of the prompt, I provided a few words for the Gen AI model to understand what kind of output I was looking for. As I iterated through this model and it’s output, I was curious to understand how this model functions, and how much of the original audio was retained versus what portions were altered to align with what the model believed to be the desired output. 

## Here's a detailed description of each sound output iteration I generated with Suno.AI:

### Output 1 (Broken Reflections):

####  Audio Input: Collide first 60 seconds 
####  Written Prompt: dramatic theatrical piano ballad accompaniment with somber strings

At first the song output is mostly just the audio file I feed the model, with some slightly modulations where the voice sounds more robotic and loses it’s human sliding nature. I could also tell where the model was unable to decipher the words used in the original song, particularly the lyric “orbiting” which sounded like a “more-be-evaling”. After the 60 seconds of my original audio file finished, the remaining 120 seconds of the output was a completely new composition with brand new lyrics. This is where the influence of the LLM portion of this model came in strong. The lyrics were very similar to the sentiment of the original audio input, but were also heavily influenced by the word prompt I provided in the beginning. 

####  Generated Lyrics:

    (Verse 1)
    Shattered glass, my heart was found, 
    cried whispers at the world around
    Shadows dance, empty hall, 
    I’ve chased the ghost but hit the wall.
    
    (Verse 2)
    Through veils of tears a truth appears,
    the silent screams no one can heal, 
    A melody of lost lament, 
    A song of sorrow never spent. 
    
    (Chorus)
    Broken reflections show the pain
    In the mirror depth I see the rain
    Tears fall softly on the floor
    I whisper but you hear no more. 
    
    (Bridge)
    A lullaby of shattered dreams 
    where nothing is ever as it seems 
    The stage is dark, the overture 
    Plays on my heart but I’m oh unsure. 
    
    (Verse 3)
    The curtains rise on endless night, 
    In this drama I lose sight of every road…

These lyrics reference key words provided in my initial prompt. Some strong examples can be seen through the lyrical sentiment of the first 2 verses. The model heavily weighted words such as “cried whispers”, “ghost”, and “veils of tears” to demonstrate a somber tone. Since my prompt included the words “ballad”, the model more heavily weighted words that had musical references like “melody of lost lament” and “song of sorrow. It also leaned in on my use of the term “theatrical” by including references to a dark stage, overture and curtains rising. The last verse in particular directly states the word “drama” which is a direct pull from the prompt provided. 

From a musical perspective, the instrumentation remained very true to the original audio sample. Certain parts of the original audio in the first 60 seconds were modified to be more normalized. In places where dramatic pauses were taken, the model struggled to recreate the song in perfect form but for the most part the song was untouched. In the last 120 seconds of the song, the instrumentation was very piano heavy which is what I desired. It added some small flourishing accents in a very uniform manner, such as walking up and down scales in eight notes. Some orchestral instruments added to the song creating overall swelling sound of more dramatic moments, but did not feature heavily which was nice. The piano tone eventually modulated into a more flat tone, similar to that of the instrument used in reflections from Mulan (which has dramatic sentiment to its lyrics as well). The addition of these instruments also helped to understand the song form being emulated here. By the 3rd verse, all the additional instruments dropped out and it went back to purely a piano sound and goes to show how much was added. 

### Output 2: In the Key of Moonlight

####  Audio Input: Collide first 60 seconds 
####  Written Prompt: piano accompaniment with somber orchestra
####  Perceived Style: lyrical, serene, orchestral

####  Generated Lyrics:

    (Verse 1)
    Underneath the pale moons gleam, 
    whispers flow like gentle streams
    Stars above in twilight schemed, 
    casting spells in endless dreams. 
    
    (Verse 2)
    Night-time since the day begins, 
    violin soar on winds, 
    piano keys like softest wind, 
    hearts in lock and love rescinds. 
    
    (Chorus)
    In the key of moonlights glow, 
    where the shadows freely grow, 
    secrets in the silent grow,
    Love’s the only path we know.
    
     (instrumental verse)
    
    (Verse 3)
     Waves of sound caress the night, 
    orchesture and pure delight 
    piano plays its gentle plight,
     guiding souls to morning light!
    
    (Chorus)
    Strings will swell and voices rise,
    Melodies that mesmerize 
    In their warmth our sorrow flies 
    Wait to find …

####  Analysis:

	The modeled struggled to understand the original song more this time evidenced through more modifications of the lyrics such as the lyric “all our past lives together in this one” was recreated as “ all our papst lives together and this wain”. The lyric “orbiting” was better understood this time but sounded like “or-budding”. The generated portion of the song had a very different vocal tonality to it verses the first song which sounded much more like the original song. This song featured some added guitar strumming which gave a more upbeat style and some added background vocals. Overall, the lyrics were a bit more hopeful in this creation while still making mention of more somber topics, but seemed to have a thesis that music is the cure for our sorrows. 

	Instrumentally, there are more additions in this iteration including some more perucussion instruments like a tambourine sound in the chorus section where the song builds. Immediately, the piano sound has a more plucky sound and has a guitar added in on verse 2 chugging on a descently fast tempo. In the chorus a chorus of voices joins the lead vocalist to build body to the song. The song keeps the same 4 chords most of the time but does lean towards the minor on the 3rd time through in a verse. The second build to a chorus in the 3rd verse is has a strong increase in the pitch of the melody which was modeled in the original audio sample during the chorus but wasn’t as prominent in the first audio output. 



### Output 3: Somber Nights

####  Audio Input: Collide 60 seconds – Chorus 
####  Perceived Style: Orchestral, Ballad, Somber. Melancholic

####  Generated Lyrics:
    (Verse 1)
    The moonlight falls on empty streets 
    A ghostly whisper no one greets 
    Shadows dance where lovers meet 
    But I’m alone my heart depletes 
    
    (Verse 2) 
    The rain it sings a mournful tune 
    A symphony beneath the moon 
    Raindrops keep an endless swoon 
    Melancholy afternoon 
    
    (Chorus) 
    In the silence I reside 
    A world where only tears abide 
    Memories in a heavy tide 
    Waves that come and sweep inside 
    
    (Verse 3)
    Broken dreams they line the floor 
    Each one’s left a painful score 
    Pictures fade but feelings store 
    I cant take this anymore 
    
    (Bridge)
    Whispers and echoes fill the air 
    Lonely spirits everywhere 
    Empty you but do they care 
    Loss is more than one can bear 
    
    (Chorus)
    In the silence I reside 
    A world where only tears abide 
    Memories in a heavy tide 
    Waves that come and sweep inside

Interestingly in this song, the vocalist changed to a more masculine voice. There was also heavy use of the major 3rd chord, similar to that of Creep by radio head and some minor 4 chords as well (which was commonly used in the original audio sample). A rapid 32nd note snare drum adds to the build of the bridge right before crescendo-ing into a chorus. In the verses, it sounds like a harp sound is providing the base line, like a warm piano sound oscillating back and forth and occasionally arpeggiating. The chorus of male voices adds in the chorus, and emphasis words like “waves that come in and sweep inside”. Verse 3 is in similar melody to the first 2 verses but modulates upwards at the end leading to the bridge. 


### Output 4: Moonlit Whispers

####  Audio Input: Collide 60 seconds – Chorus 
####  Perceived Style: Grand, Orchestral, Ballad 

####  Generated Lyrics: 
    (Verse 1)
    Walking under moonlit skies
    Whispers in the night arise 
    Stars are singing lullabies 
    Love within your eyes 
    
    (Chorus)
    Moonlit whispers shared so sweet 
    Hearts together in the beat 
    Every glance a soft deceit 
    Magic on this street 
    
    (Verse 2) 
    Waves of dreams in silky haze 
    Wander through the nighttime maze 
    In your gaze 
    The world ablaze 
    Moonlight’s tender praise 
    
    (Chorus 2)
    Moonlit whispers shared so sweet 
    Hearts together in the beat 
    Every glance a soft deceit 
    Magic on this street 
    
    (Bridge) 
    Soft caress and midnight flow 
    Holding on and never let go 
    Time stands still when we’re been low 
    Love in undertow 
    
    (Chorus 3)
    Moonlit whispers shared so sweet 
    Hearts together in the beat 
    Every moment so complete 
    Magic on this street

Interestingly, this iteration gave 2 versions, one with a masculine voice and one with a feminine voice. This version also changed the chords in the beginning 60 seconds, misplacing the order of chords from the first iteration. It also widened the sound of the original voice, making it sound like she was smiling more while singing, brighter in nature. This time it rushed to the minor 4 before it was appropriate. It also changed the arrangement and added more high notes. In the generative AI, it added more low-end piano. It’s interesting how each of these iterations are leaning so much in on the theme of moonlight when none of that is directly expressed in the original song or in the written prompts. This version also added a chorus of voices and some electric reverb which built and added to the lofi feel of this song. The bridge opened to an interesting major chord 

There was another version of this song done with a feminine voice which was more stripped down, including a guitar on the chorus and less background vocals. It had more of an acoustic sound to it. I could tune into the steal strings of the guitar. The background vocals and harmonies only came in on the second Chorus. Then were added as needed in the bridge. 

For fun I added some very different written prompts to see their impact: 

### Output 5: Let’s Dance All Night

####  Audio Input: Collide first 60 seconds 
####  Written Prompt: electric dance upbeat 
####  Perceived Style: dance, electric

####  Generated Lyrics: 
 
    (Verse 1)
    Neon lights
    Shining bright
    Feel the beat 
    Take the flight 
    Dancing shoes 
    On our feet 
    Let’s move 
    
    (Verse 2)
    Bass drops 
    Hearts stop 
    Hands up 
    To the top 
    Feel alive 
    In the night (ooh-yeah!)
    Sparkle bright 
    Hold tight 
    
    (Chorus)
    Let’s dance 
    All night 
    Underneath
    The starlight 
    We’ll dance 
    All night 
    Feel the love 
    So right 
    
    (Verse 3)
    Rhythm flows 
    Like the sea 
    Set us free 
    Let it be 
    Heart beat 
    In the air 
    Feel the glow 
    Everywhere 
    
    (Bridge) 
    Lose yourself 
    To the sound 
    Feel the vibe 
    All around 
    Never stop
    Stay in motion 
    Feel the waves 
    Of Emotion 
    
    (Chorus 2) 
    Lets dance 
    All night 
    Underneath 
    The starlight 
    We’ll odance 
    All night 
    Feel the love 
    So right (ooh-yeah!)

	This iteration went to demonstrate that the audio sample being so close to a fully formed song weighted heavily in the model and was not easily swayed by the written prompt asking for a very different genre / style. Instead, the lyrics were more expressive of the dance and electric energy. The original audio was not as modified as in previous iterations and had less artifacts which was a benefit. The chords had some major 3rds and minor 4ths and also featured some more drums and guitars like a broad group of singers. 

### Output 6: Eternal Night

####  Audio Input: Collide first 60 seconds
####  Written Prompt: Lyrical ballad
####  Perceived Style: Lyrical, Moody, Piano, Ballad

####  Generated Lyrics:
 
    [Verse]
    In shadows deep we find the light
    Moon whispers secrets through the night
    Far away stars begin their dance
    Captured lost in this trance
    
    [Verse 2]
    Waves crash softly on the shore
    Echoes of a love long gone before
    Memories linger in the breeze
    Hearts frozen in time's frieze
    
    [Chorus]
    Hold on tight to dreams that fly
    Underneath an endless sky
    Tears may fall but we survive
    In this dark we come alive
    
    [Bridge]
    Whispers of your voice are near
    In the silence I find you here
    Eyes closed shut yet I can see
    The love that binds eternally
    
    [Verse 3]
    With every heartbeat time stands still
    In the quiet I feel the thrill
    Moments pass but we stay strong
    Together right where we belong
    
    [Chorus]
    Hold on tight to dreams that fly
    Underneath an endless sky
    Tears may fall but we survive
    In this dark we come alive


	“Withdrawn” was modulated down and surrender wasn’t read correctly, it came through as “surrend-ed”. This version kept the piano similar to the original, but added a minor chord, before “ far away stars dance”. The voice remained mostly a solo with some doubling. And instrumentals remained just a piano. The chords were definitely changed and had more minor tone, there was a slight addition of some strummed like instrument as the sound quality decayed. Interestingly, “freeze” was misspelled as “frieze”, I wonder if the model meant for a different word to be used. 
The second model output, had more percussion added, some snare and shakers, making it feel more upbeat. It also added a guitar sound as it entered into the chorus, as well as some doubling of voices. The bridge had the strongest build. The syncopated feeling of the base line was similar to the original pattern of the audio file, but was more regulated hence giving a more upbeat and positive tone. 

### Output 7a: Stormy Hearts (Instrumental)

####  Audio Input: Collide first 60 seconds
####  Written Prompt: Lyrical ballad
####  Perceived Style: Ballad, Lyrical, Acoustic, Melodic, Folk 

*No lyrics were generated as an instrumental piece.*

	Initial reaction: This piece takes on a much more minor nature of the song, adds intensity with drums beat and oscillating arpeggiated piano line as well as some synth sounds that create waves of tension. It first starts with a simple piano part, and keeps that piano harmonic structure throughout the song, not changing so much throughout. There isn’t much of a melody line, the piano arpeggiation takes center stage. 


### Output 7b: Stormy Hearts (Instrumental)

####  Audio Input: Collide first 60 seconds
####  Written Prompt: Lyrical ballad
####  Perceived Style: Ballad, Lyrical, Acoustic, Melodic, Folk 

*No lyrics generated as an instrumental piece.*

	This iteration is much slower paced, similar to that of the original piece and has a melody line carried by the stringed instruments which sound similar to the original piece. There is the addition of other stringed instruments as well interestingly enough given the prompt gave no indication of orchestral or stringed instruments. This version adds drums as well only halfway through, a simple upbeat 4 count. The melody switches from stringed orchestral instrument to a guitar melody as the drums build in the chorus. 

### Output 8a: Heartquake (Instrumental)

####  Audio Input: Collide 60 seconds – Chorus 
####  Written Prompt: Intense emotional
####  Perceived Style: emotive, emotional, piano-driven, ballad

	Initially very piano driven but more of an accompaniment piece than having melody featured on another instrument. This sounds like something I could model the piano arrangement off of. The harmonic structure also closely followed the chorus of the original song, but only the first part which cycles from (C Am G). Then it slows to a bridge portion without the bass in the piano, but achieves a very nice rubato sound which mimics the lack of tempo the original piece has a certain times. At the end the model also added a synthetic sound of someone stepping away from the piano as if to grab their phone and turn off a recording device (a very nice human touch). 
	

### Output 8b: Heartquake (Instrumental) 

####  Audio Input: Collide 60 seconds – Chorus 
####  Written Prompt: Intense emotional
####  Perceived Style: emotive, emotional, piano-driven, ballad


	Added guitar strings specifically steel strings, very high pitched with some pitch bending. This followed the harmonic structure of the original song much more closely, using the same minor 4 structure. There was a second section which melodically followed quite similar to the original audio with a clarinet / reed instrument as well and added a nice jazzy interpretation of the melody. 


## Original Song Collide Lyrics

*   Verse 1:
    Csus C
    Once upon a time 
    I became too sentimental 
    Am 
    I got lost inside my mind
    G
    Too nostalgic for what was
    
    C
    I couldn’t see the light 
    In the bitter New York winters
    Am
    Withdrawn into myself
    G 
    I was alone  
    
    Pre chorus:
    F Fm
    Forced to surrender  
    
    Chorus:
    C 
    I’ve loved you all my life 
    Am (F Fm) 
    All our past lives together and this one
    C G 
    Once upon a time and the time after time before 
    F Fm C G 
    I gave you everything, orbiting, and I know that I’ll give it again 
    F Fm C 
    we’ll collide 
    When we’re young again 
    
    Verse 2:
    C Am G 
    Once upon a time 
    I became too sentimental 
    In the carnage of my heart 
    Estranged from what it was 
    
    You’re a beacon in the night 
    And a warmth in all the wreckage 
    The tides are rolling in and I can see 
    
    F                                       
    The ties won’t sever it feels 
    Like now or never 
    
    
    Chorus 2: 
    C 
    I’ve loved you all my life 
    Am (F Fm) 
    All our past lives together and this one
    C G 
    I’ve known you a thousands years 
    And I’ll know you 1000 more
    
    F Fm C G 
    Just take my hand and spin, orbiting, Spiral round as we start it again  
    F Fm C 
    we’ll collide 
    Am 
    When we’re young again 
    F Fm C 
    It makes sense 
    That it’s you my friend  
    We’ll collide when we’re young again*
    
    
    
    
